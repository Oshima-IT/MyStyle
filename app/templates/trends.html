{% extends "base.html" %}

{% block title %}MyStyle - トレンド{% endblock %}

{% block content %}

<!-- ▼ タブ（ホーム / トレンド） -->
<div class="page-tabs">
    <a href="{{ url_for('home') }}" class="tab">ホーム</a>
    <a href="{{ url_for('trends') }}" class="tab active">トレンド</a>
</div>

<!-- =========================
     ZOZO × トレンド評価
     ========================= -->
{% if zozo_evaluation %}
<div class="card" style="background:#f5f9ff;">
    <h3>ZOZOTOWN トレンド評価</h3>

    <p>
        総合スコア：
        <b style="font-size:20px;">
            {{ zozo_evaluation.score }}
        </b>
    </p>

    <p>
        評価ランク：
        <span style="font-weight:bold; color:#2a5;">
            {{ zozo_evaluation.rank }}
        </span>
    </p>

    <p style="color:#666;">
        {{ zozo_evaluation.reason }}
    </p>
</div>
{% endif %}

<!-- =========================
     Googleトレンド
     ========================= -->
{% if google_trend %}
<div class="card" style="background:#f3f8ff;">
    <h3>
        Googleトレンド：
        「{{ google_trend.primary_keyword if google_trend.primary_keyword else 'ファッション' }}」
    </h3>
    <p>
        最新データ（{{ google_trend.date }}）：
        人気度 = <b>{{ google_trend.value }}</b>
    </p>
</div>
{% elif google_trend_error %}
<div class="card" style="background:#fff0f0; color:#b00;">
    <h3>Googleトレンド取得エラー</h3>
    <p>{{ google_trend_error }}</p>
</div>
{% endif %}

<!-- =========================
     Googleトレンド関連キーワード
     ========================= -->
{% if related_keywords and related_keywords|length > 0 %}
<div class="card" style="background:#f8fafd;">
    <h3>関連キーワード</h3>
    <ol>
        {% for kw in related_keywords %}
        <li>
            <a href="{{ url_for('home', search=kw.keyword) }}"
               style="text-decoration: underline; color:#333;">
                {{ kw.keyword }}
            </a>
            <span style="color:#888; font-size:13px;">
                （{{ kw.value }}）
            </span>
        </li>
        {% endfor %}
    </ol>
</div>
{% endif %}

<!-- =========================
     DBに保存されたトレンド情報
     ========================= -->
{% if trends and trends|length > 0 %}
{% for t in trends %}
<div class="card">
    <h3>{{ t.title }}</h3>

    {% if t.image_url %}
    <img src="{{ t.image_url }}"
         alt="{{ t.title }}"
         style="width:100%; max-width:400px; border-radius:8px; margin-bottom:12px;">
    {% endif %}

    <p>{{ t.description }}</p>

    {% if t.search_keyword %}
    <a href="https://zozo.jp/search/?p_keyv={{ t.search_keyword }}"
       target="_blank"
       class="btn">
        ZOZOTOWNで探す
    </a>
    {% endif %}
</div>
{% endfor %}
{% else %}
<p>現在表示できるトレンド情報がありません。</p>
{% endif %}

{% endblock %}
